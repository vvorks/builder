//
// schema.sql用テンプレート
//
{{#resources this "sql/schema.sql"}}
{{#each this.classes}}
CREATE TABLE IF NOT EXISTS {{tableName}} (
	{{#each properties}}
	{{columnName}} {{columnType}} {{#if notNull}}NOT NULL{{/if}},
	{{/each}}
	PRIMARY KEY (
		{{#each keys}}
		{{columnName}}{{#separator}},{{/separator}}
		{{/each}}
	)
	{{#if refs}}
	{{#each refs}}
	FOREIGN KEY (
		{{#each refKeyFields}}
		{{columnName}}{{#separator}},{{/separator}}
		{{/each}}
	) REFERENCES {{cref.tableName}} (
		{{#each cref.keys}}
		{{columnName}}{{#separator}},{{/separator}}
		{{/each}}
	)
	{{/each}}
	{{/if}}
);
{{/each}}
{{/resources}}
//
// data.sql用テンプレート(builderプロジェクト専用)
//
{{#if this.builderProject}}
{{#resources this "sql/data.sql"}}
{{global.disableForeignKey}};
{{#each this.classes}}
{{#if values}}
INSERT INTO {{tableName}} (
	{{#each properties}}
	{{columnName}}{{#separator}},{{/separator}}
	{{/each}}
) VALUES
	{{#each values}}
	({{#each this}}{{this}}{{#separator}},{{/separator}}{{/each}}){{#separator}},{{/separator}}
	{{/each}}
ON CONFLICT DO NOTHING;
{{/if}}
{{/each}}
{{global.enableForeignKey}};
{{/resources}}
{{/if}}

