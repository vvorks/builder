<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.github.vvorks.builder.server.mapper.ClassMapper">

	<insert id="insert" parameterType="ClassContent">
		INSERT INTO T_CLASS (
			F_CLASS_ID,
			F_OWNER_PROJECT_ID,
			F_CLASS_NAME,
			F_TITLE,
			F_DESCRIPTION,
			F_NOTE
		) VALUES (
			#{ classId },
			#{ ownerProjectId },
			#{ className },
			#{ title },
			#{ description },
			#{ note }
		)
	</insert>

	<update id="update" parameterType="ClassContent">
		UPDATE T_CLASS SET
			F_OWNER_PROJECT_ID = #{ ownerProjectId },
			F_CLASS_NAME = #{ className },
			F_TITLE = #{ title },
			F_DESCRIPTION = #{ description },
			F_NOTE = #{ note }
		WHERE
			F_CLASS_ID = #{ classId }
	</update>

	<delete id="delete" parameterType="ClassContent">
		DELETE FROM T_CLASS
		WHERE
			F_CLASS_ID = #{ classId }
	</delete>

	<select id="get" resultType="ClassContent">
		SELECT
			F_CLASS_ID AS "classId",
			F_OWNER_PROJECT_ID AS "ownerProjectId",
			F_CLASS_NAME AS "className",
			F_TITLE AS "title",
			F_DESCRIPTION AS "description",
			F_NOTE AS "note"
		FROM
			T_CLASS
		WHERE
			F_CLASS_ID = #{ classId }
	</select>

	<select id="listSummary" resultType="ClassSummary">
		SELECT
			COUNT(*) AS "count"
		FROM
			T_CLASS
	</select>

	<select id="listContent" resultType="ClassContent">
		SELECT
			F_CLASS_ID AS "classId",
			F_OWNER_PROJECT_ID AS "ownerProjectId",
			F_CLASS_NAME AS "className",
			F_TITLE AS "title",
			F_DESCRIPTION AS "description",
			F_NOTE AS "note"
		FROM
			T_CLASS
		<if test="limit &gt; 0">
			LIMIT #{limit}
		<if test="offset &gt;= 0">
			OFFSET #{offset}
		</if>
		</if>
	</select>

	<select id="findSummary" resultType="ClassSummary">
		SELECT
			COUNT(*) AS "count"
		FROM
			T_CLASS
		<where>
			<if test="ownerProjectId != null">
				AND F_OWNER_PROJECT_ID = #{ ownerProjectId }
			</if>
			<if test="className != null">
				AND F_CLASS_NAME = #{ className }
			</if>
			<if test="title != null">
				AND F_TITLE = #{ title }
			</if>
		</where>
	</select>

	<select id="findContent" resultType="ClassContent">
		SELECT
			F_CLASS_ID AS "classId",
			F_OWNER_PROJECT_ID AS "ownerProjectId",
			F_CLASS_NAME AS "className",
			F_TITLE AS "title",
			F_DESCRIPTION AS "description",
			F_NOTE AS "note"
		FROM
			T_CLASS
		<where>
			<if test="ownerProjectId != null">
				AND F_OWNER_PROJECT_ID = #{ ownerProjectId }
			</if>
			<if test="className != null">
				AND F_CLASS_NAME = #{ className }
			</if>
			<if test="title != null">
				AND F_TITLE = #{ title }
			</if>
		</where>
		<if test="limit &gt; 0">
			LIMIT #{limit}
		<if test="offset &gt;= 0">
			OFFSET #{offset}
		</if>
		</if>
	</select>

	<select id="getOwner" resultType="ProjectContent">
		SELECT
			F_PROJECT_ID AS "projectId",
			F_PROJECT_NAME AS "projectName",
			F_TITLE AS "title",
			F_DESCRIPTION AS "description",
			F_NOTE AS "note",
			F_COPYRIGHTS AS "copyrights"
		FROM
			T_PROJECT
		WHERE
			F_PROJECT_ID = #{ ownerProjectId }
	</select>

	<select id="listFieldsSummary" resultType="FieldSummary">
		SELECT
			COUNT(*) AS "count"
		FROM
			T_FIELD
		WHERE
			F_OWNER_CLASS_ID = #{ content.classId }
	</select>

	<select id="listFieldsContent" resultType="FieldContent">
		SELECT
			F_FIELD_ID AS "fieldId",
			F_OWNER_CLASS_ID AS "ownerClassId",
			F_FIELD_NAME AS "fieldName",
			F_TYPE AS "type",
			F_WIDTH AS "width",
			F_SCALE AS "scale",
			F_CREF_CLASS_ID AS "crefClassId",
			F_EREF_ENUM_ID AS "erefEnumId",
			F_FREF_FIELD_ID AS "frefFieldId",
			F_PK AS "pk",
			F_NULLABLE AS "nullable",
			F_NEEDS_SUM AS "needsSum",
			F_NEEDS_AVG AS "needsAvg",
			F_NEEDS_MAX AS "needsMax",
			F_NEEDS_MIN AS "needsMin",
			F_TITLE AS "title",
			F_DESCRIPTION AS "description",
			F_NOTE AS "note"
		FROM
			T_FIELD
		WHERE
			F_OWNER_CLASS_ID = #{ content.classId }
		<if test="limit &gt; 0">
			LIMIT #{limit}
		<if test="offset &gt;= 0">
			OFFSET #{offset}
		</if>
		</if>
	</select>

	<select id="listFieldsIfIsPkSummary" resultType="FieldSummary">
		SELECT
			COUNT(*) AS "count"
		FROM
			T_FIELD T1
		WHERE
			T1.F_OWNER_CLASS_ID = #{ content.classId }
			<![CDATA[
			AND (T1.F_PK == 1)
			]]>
	</select>

	<select id="listFieldsIfIsPkContent" resultType="FieldContent">
		SELECT
			T1.F_FIELD_ID AS "fieldId",
			T1.F_OWNER_CLASS_ID AS "ownerClassId",
			T1.F_FIELD_NAME AS "fieldName",
			T1.F_TYPE AS "type",
			T1.F_WIDTH AS "width",
			T1.F_SCALE AS "scale",
			T1.F_CREF_CLASS_ID AS "crefClassId",
			T1.F_EREF_ENUM_ID AS "erefEnumId",
			T1.F_FREF_FIELD_ID AS "frefFieldId",
			T1.F_PK AS "pk",
			T1.F_NULLABLE AS "nullable",
			T1.F_NEEDS_SUM AS "needsSum",
			T1.F_NEEDS_AVG AS "needsAvg",
			T1.F_NEEDS_MAX AS "needsMax",
			T1.F_NEEDS_MIN AS "needsMin",
			T1.F_TITLE AS "title",
			T1.F_DESCRIPTION AS "description",
			T1.F_NOTE AS "note"
		FROM
			T_FIELD T1
		WHERE
			T1.F_OWNER_CLASS_ID = #{ content.classId }
			<![CDATA[
			AND (T1.F_PK == 1)
			]]>
		<if test="limit &gt; 0">
			LIMIT #{limit}
		<if test="offset &gt;= 0">
			OFFSET #{offset}
		</if>
		</if>
	</select>

	<select id="findFieldsSummary" resultType="FieldSummary">
		SELECT
			COUNT(*) AS "count"
		FROM
			T_FIELD
		WHERE
			F_OWNER_CLASS_ID = #{ content.classId }
			<if test="ownerClassId != null">
				AND F_OWNER_CLASS_ID = #{ ownerClassId }
			</if>
			<if test="fieldName != null">
				AND F_FIELD_NAME = #{ fieldName }
			</if>
			<if test="type != null">
				AND F_TYPE = #{ type }
			</if>
			<if test="width != null">
				AND F_WIDTH = #{ width }
			</if>
			<if test="scale != null">
				AND F_SCALE = #{ scale }
			</if>
			<if test="crefClassId != null">
				AND F_CREF_CLASS_ID = #{ crefClassId }
			</if>
			<if test="erefEnumId != null">
				AND F_EREF_ENUM_ID = #{ erefEnumId }
			</if>
			<if test="frefFieldId != null">
				AND F_FREF_FIELD_ID = #{ frefFieldId }
			</if>
			<if test="pk != null">
				AND F_PK = #{ pk }
			</if>
			<if test="nullable != null">
				AND F_NULLABLE = #{ nullable }
			</if>
			<if test="needsSum != null">
				AND F_NEEDS_SUM = #{ needsSum }
			</if>
			<if test="needsAvg != null">
				AND F_NEEDS_AVG = #{ needsAvg }
			</if>
			<if test="needsMax != null">
				AND F_NEEDS_MAX = #{ needsMax }
			</if>
			<if test="needsMin != null">
				AND F_NEEDS_MIN = #{ needsMin }
			</if>
			<if test="title != null">
				AND F_TITLE = #{ title }
			</if>
	</select>

	<select id="findFieldsContent" resultType="FieldContent">
		SELECT
			F_FIELD_ID AS "fieldId",
			F_OWNER_CLASS_ID AS "ownerClassId",
			F_FIELD_NAME AS "fieldName",
			F_TYPE AS "type",
			F_WIDTH AS "width",
			F_SCALE AS "scale",
			F_CREF_CLASS_ID AS "crefClassId",
			F_EREF_ENUM_ID AS "erefEnumId",
			F_FREF_FIELD_ID AS "frefFieldId",
			F_PK AS "pk",
			F_NULLABLE AS "nullable",
			F_NEEDS_SUM AS "needsSum",
			F_NEEDS_AVG AS "needsAvg",
			F_NEEDS_MAX AS "needsMax",
			F_NEEDS_MIN AS "needsMin",
			F_TITLE AS "title",
			F_DESCRIPTION AS "description",
			F_NOTE AS "note"
		FROM
			T_FIELD
		WHERE
			F_OWNER_CLASS_ID = #{ content.classId }
			<if test="ownerClassId != null">
				AND F_OWNER_CLASS_ID = #{ ownerClassId }
			</if>
			<if test="fieldName != null">
				AND F_FIELD_NAME = #{ fieldName }
			</if>
			<if test="type != null">
				AND F_TYPE = #{ type }
			</if>
			<if test="width != null">
				AND F_WIDTH = #{ width }
			</if>
			<if test="scale != null">
				AND F_SCALE = #{ scale }
			</if>
			<if test="crefClassId != null">
				AND F_CREF_CLASS_ID = #{ crefClassId }
			</if>
			<if test="erefEnumId != null">
				AND F_EREF_ENUM_ID = #{ erefEnumId }
			</if>
			<if test="frefFieldId != null">
				AND F_FREF_FIELD_ID = #{ frefFieldId }
			</if>
			<if test="pk != null">
				AND F_PK = #{ pk }
			</if>
			<if test="nullable != null">
				AND F_NULLABLE = #{ nullable }
			</if>
			<if test="needsSum != null">
				AND F_NEEDS_SUM = #{ needsSum }
			</if>
			<if test="needsAvg != null">
				AND F_NEEDS_AVG = #{ needsAvg }
			</if>
			<if test="needsMax != null">
				AND F_NEEDS_MAX = #{ needsMax }
			</if>
			<if test="needsMin != null">
				AND F_NEEDS_MIN = #{ needsMin }
			</if>
			<if test="title != null">
				AND F_TITLE = #{ title }
			</if>
		<if test="limit &gt; 0">
			LIMIT #{limit}
		<if test="offset &gt;= 0">
			OFFSET #{offset}
		</if>
		</if>
	</select>

	<select id="listQueriesSummary" resultType="QuerySummary">
		SELECT
			COUNT(*) AS "count"
		FROM
			T_QUERY
		WHERE
			F_OWNER_CLASS_ID = #{ content.classId }
	</select>

	<select id="listQueriesContent" resultType="QueryContent">
		SELECT
			F_QUERY_ID AS "queryId",
			F_OWNER_CLASS_ID AS "ownerClassId",
			F_QUERY_NAME AS "queryName",
			F_FILTER AS "filter",
			F_ORDER AS "order",
			F_TITLE AS "title",
			F_DESCRIPTION AS "description",
			F_NOTE AS "note"
		FROM
			T_QUERY
		WHERE
			F_OWNER_CLASS_ID = #{ content.classId }
		<if test="limit &gt; 0">
			LIMIT #{limit}
		<if test="offset &gt;= 0">
			OFFSET #{offset}
		</if>
		</if>
	</select>

	<select id="findQueriesSummary" resultType="QuerySummary">
		SELECT
			COUNT(*) AS "count"
		FROM
			T_QUERY
		WHERE
			F_OWNER_CLASS_ID = #{ content.classId }
			<if test="ownerClassId != null">
				AND F_OWNER_CLASS_ID = #{ ownerClassId }
			</if>
			<if test="queryName != null">
				AND F_QUERY_NAME = #{ queryName }
			</if>
			<if test="filter != null">
				AND F_FILTER = #{ filter }
			</if>
			<if test="order != null">
				AND F_ORDER = #{ order }
			</if>
			<if test="title != null">
				AND F_TITLE = #{ title }
			</if>
	</select>

	<select id="findQueriesContent" resultType="QueryContent">
		SELECT
			F_QUERY_ID AS "queryId",
			F_OWNER_CLASS_ID AS "ownerClassId",
			F_QUERY_NAME AS "queryName",
			F_FILTER AS "filter",
			F_ORDER AS "order",
			F_TITLE AS "title",
			F_DESCRIPTION AS "description",
			F_NOTE AS "note"
		FROM
			T_QUERY
		WHERE
			F_OWNER_CLASS_ID = #{ content.classId }
			<if test="ownerClassId != null">
				AND F_OWNER_CLASS_ID = #{ ownerClassId }
			</if>
			<if test="queryName != null">
				AND F_QUERY_NAME = #{ queryName }
			</if>
			<if test="filter != null">
				AND F_FILTER = #{ filter }
			</if>
			<if test="order != null">
				AND F_ORDER = #{ order }
			</if>
			<if test="title != null">
				AND F_TITLE = #{ title }
			</if>
		<if test="limit &gt; 0">
			LIMIT #{limit}
		<if test="offset &gt;= 0">
			OFFSET #{offset}
		</if>
		</if>
	</select>

</mapper>
